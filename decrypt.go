// Copyright 2012 Dmitry Chestnykh. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

package threefish

func decryptBlock(ks *[9]uint64, ts *[3]uint64, dst, src []byte) {
	x0 := uint64(src[0]) | uint64(src[1])<<8 | uint64(src[2])<<16 | uint64(src[3])<<24 |
		uint64(src[4])<<32 | uint64(src[5])<<40 | uint64(src[6])<<48 | uint64(src[7])<<56
	x1 := uint64(src[8]) | uint64(src[9])<<8 | uint64(src[10])<<16 | uint64(src[11])<<24 |
		uint64(src[12])<<32 | uint64(src[13])<<40 | uint64(src[14])<<48 | uint64(src[15])<<56
	x2 := uint64(src[16]) | uint64(src[17])<<8 | uint64(src[18])<<16 | uint64(src[19])<<24 |
		uint64(src[20])<<32 | uint64(src[21])<<40 | uint64(src[22])<<48 | uint64(src[23])<<56
	x3 := uint64(src[24]) | uint64(src[25])<<8 | uint64(src[26])<<16 | uint64(src[27])<<24 |
		uint64(src[28])<<32 | uint64(src[29])<<40 | uint64(src[30])<<48 | uint64(src[31])<<56
	x4 := uint64(src[32]) | uint64(src[33])<<8 | uint64(src[34])<<16 | uint64(src[35])<<24 |
		uint64(src[36])<<32 | uint64(src[37])<<40 | uint64(src[38])<<48 | uint64(src[39])<<56
	x5 := uint64(src[40]) | uint64(src[41])<<8 | uint64(src[42])<<16 | uint64(src[43])<<24 |
		uint64(src[44])<<32 | uint64(src[45])<<40 | uint64(src[46])<<48 | uint64(src[47])<<56
	x6 := uint64(src[48]) | uint64(src[49])<<8 | uint64(src[50])<<16 | uint64(src[51])<<24 |
		uint64(src[52])<<32 | uint64(src[53])<<40 | uint64(src[54])<<48 | uint64(src[55])<<56
	x7 := uint64(src[56]) | uint64(src[57])<<8 | uint64(src[58])<<16 | uint64(src[59])<<24 |
		uint64(src[60])<<32 | uint64(src[61])<<40 | uint64(src[62])<<48 | uint64(src[63])<<56

	x0 -= ks[0]
	x1 -= ks[1]
	x2 -= ks[2]
	x3 -= ks[3]
	x4 -= ks[4]
	x5 -= ks[5] + ts[0]
	x6 -= ks[6] + ts[1]
	x7 -= ks[7] + 18

	u := x3 ^ x4
	x3 = u>>22 | u<<(64-22)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>56 | u<<(64-56)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>35 | u<<(64-35)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>8 | u<<(64-8)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>43 | u<<(64-43)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>39 | u<<(64-39)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>29 | u<<(64-29)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>25 | u<<(64-25)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>17 | u<<(64-17)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>10 | u<<(64-10)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>50 | u<<(64-50)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>13 | u<<(64-13)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>24 | u<<(64-24)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>34 | u<<(64-34)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>30 | u<<(64-30)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>39 | u<<(64-39)
	x0 -= x1

	x0 -= ks[8]
	x1 -= ks[0]
	x2 -= ks[1]
	x3 -= ks[2]
	x4 -= ks[3]
	x5 -= ks[4] + ts[2]
	x6 -= ks[5] + ts[0]
	x7 -= ks[6] + 17

	u = x3 ^ x4
	x3 = u>>56 | u<<(64-56)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>54 | u<<(64-54)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>9 | u<<(64-9)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>44 | u<<(64-44)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>39 | u<<(64-39)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>36 | u<<(64-36)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>49 | u<<(64-49)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>17 | u<<(64-17)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>42 | u<<(64-42)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>14 | u<<(64-14)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>27 | u<<(64-27)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>33 | u<<(64-33)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>37 | u<<(64-37)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>19 | u<<(64-19)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>36 | u<<(64-36)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>46 | u<<(64-46)
	x0 -= x1

	x0 -= ks[7]
	x1 -= ks[8]
	x2 -= ks[0]
	x3 -= ks[1]
	x4 -= ks[2]
	x5 -= ks[3] + ts[1]
	x6 -= ks[4] + ts[2]
	x7 -= ks[5] + 16

	u = x3 ^ x4
	x3 = u>>22 | u<<(64-22)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>56 | u<<(64-56)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>35 | u<<(64-35)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>8 | u<<(64-8)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>43 | u<<(64-43)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>39 | u<<(64-39)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>29 | u<<(64-29)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>25 | u<<(64-25)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>17 | u<<(64-17)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>10 | u<<(64-10)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>50 | u<<(64-50)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>13 | u<<(64-13)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>24 | u<<(64-24)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>34 | u<<(64-34)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>30 | u<<(64-30)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>39 | u<<(64-39)
	x0 -= x1

	x0 -= ks[6]
	x1 -= ks[7]
	x2 -= ks[8]
	x3 -= ks[0]
	x4 -= ks[1]
	x5 -= ks[2] + ts[0]
	x6 -= ks[3] + ts[1]
	x7 -= ks[4] + 15

	u = x3 ^ x4
	x3 = u>>56 | u<<(64-56)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>54 | u<<(64-54)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>9 | u<<(64-9)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>44 | u<<(64-44)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>39 | u<<(64-39)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>36 | u<<(64-36)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>49 | u<<(64-49)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>17 | u<<(64-17)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>42 | u<<(64-42)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>14 | u<<(64-14)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>27 | u<<(64-27)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>33 | u<<(64-33)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>37 | u<<(64-37)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>19 | u<<(64-19)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>36 | u<<(64-36)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>46 | u<<(64-46)
	x0 -= x1

	x0 -= ks[5]
	x1 -= ks[6]
	x2 -= ks[7]
	x3 -= ks[8]
	x4 -= ks[0]
	x5 -= ks[1] + ts[2]
	x6 -= ks[2] + ts[0]
	x7 -= ks[3] + 14

	u = x3 ^ x4
	x3 = u>>22 | u<<(64-22)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>56 | u<<(64-56)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>35 | u<<(64-35)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>8 | u<<(64-8)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>43 | u<<(64-43)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>39 | u<<(64-39)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>29 | u<<(64-29)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>25 | u<<(64-25)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>17 | u<<(64-17)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>10 | u<<(64-10)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>50 | u<<(64-50)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>13 | u<<(64-13)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>24 | u<<(64-24)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>34 | u<<(64-34)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>30 | u<<(64-30)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>39 | u<<(64-39)
	x0 -= x1

	x0 -= ks[4]
	x1 -= ks[5]
	x2 -= ks[6]
	x3 -= ks[7]
	x4 -= ks[8]
	x5 -= ks[0] + ts[1]
	x6 -= ks[1] + ts[2]
	x7 -= ks[2] + 13

	u = x3 ^ x4
	x3 = u>>56 | u<<(64-56)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>54 | u<<(64-54)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>9 | u<<(64-9)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>44 | u<<(64-44)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>39 | u<<(64-39)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>36 | u<<(64-36)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>49 | u<<(64-49)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>17 | u<<(64-17)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>42 | u<<(64-42)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>14 | u<<(64-14)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>27 | u<<(64-27)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>33 | u<<(64-33)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>37 | u<<(64-37)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>19 | u<<(64-19)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>36 | u<<(64-36)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>46 | u<<(64-46)
	x0 -= x1

	x0 -= ks[3]
	x1 -= ks[4]
	x2 -= ks[5]
	x3 -= ks[6]
	x4 -= ks[7]
	x5 -= ks[8] + ts[0]
	x6 -= ks[0] + ts[1]
	x7 -= ks[1] + 12

	u = x3 ^ x4
	x3 = u>>22 | u<<(64-22)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>56 | u<<(64-56)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>35 | u<<(64-35)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>8 | u<<(64-8)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>43 | u<<(64-43)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>39 | u<<(64-39)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>29 | u<<(64-29)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>25 | u<<(64-25)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>17 | u<<(64-17)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>10 | u<<(64-10)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>50 | u<<(64-50)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>13 | u<<(64-13)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>24 | u<<(64-24)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>34 | u<<(64-34)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>30 | u<<(64-30)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>39 | u<<(64-39)
	x0 -= x1

	x0 -= ks[2]
	x1 -= ks[3]
	x2 -= ks[4]
	x3 -= ks[5]
	x4 -= ks[6]
	x5 -= ks[7] + ts[2]
	x6 -= ks[8] + ts[0]
	x7 -= ks[0] + 11

	u = x3 ^ x4
	x3 = u>>56 | u<<(64-56)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>54 | u<<(64-54)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>9 | u<<(64-9)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>44 | u<<(64-44)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>39 | u<<(64-39)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>36 | u<<(64-36)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>49 | u<<(64-49)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>17 | u<<(64-17)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>42 | u<<(64-42)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>14 | u<<(64-14)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>27 | u<<(64-27)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>33 | u<<(64-33)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>37 | u<<(64-37)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>19 | u<<(64-19)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>36 | u<<(64-36)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>46 | u<<(64-46)
	x0 -= x1

	x0 -= ks[1]
	x1 -= ks[2]
	x2 -= ks[3]
	x3 -= ks[4]
	x4 -= ks[5]
	x5 -= ks[6] + ts[1]
	x6 -= ks[7] + ts[2]
	x7 -= ks[8] + 10

	u = x3 ^ x4
	x3 = u>>22 | u<<(64-22)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>56 | u<<(64-56)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>35 | u<<(64-35)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>8 | u<<(64-8)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>43 | u<<(64-43)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>39 | u<<(64-39)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>29 | u<<(64-29)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>25 | u<<(64-25)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>17 | u<<(64-17)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>10 | u<<(64-10)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>50 | u<<(64-50)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>13 | u<<(64-13)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>24 | u<<(64-24)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>34 | u<<(64-34)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>30 | u<<(64-30)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>39 | u<<(64-39)
	x0 -= x1

	x0 -= ks[0]
	x1 -= ks[1]
	x2 -= ks[2]
	x3 -= ks[3]
	x4 -= ks[4]
	x5 -= ks[5] + ts[0]
	x6 -= ks[6] + ts[1]
	x7 -= ks[7] + 9

	u = x3 ^ x4
	x3 = u>>56 | u<<(64-56)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>54 | u<<(64-54)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>9 | u<<(64-9)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>44 | u<<(64-44)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>39 | u<<(64-39)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>36 | u<<(64-36)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>49 | u<<(64-49)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>17 | u<<(64-17)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>42 | u<<(64-42)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>14 | u<<(64-14)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>27 | u<<(64-27)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>33 | u<<(64-33)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>37 | u<<(64-37)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>19 | u<<(64-19)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>36 | u<<(64-36)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>46 | u<<(64-46)
	x0 -= x1

	x0 -= ks[8]
	x1 -= ks[0]
	x2 -= ks[1]
	x3 -= ks[2]
	x4 -= ks[3]
	x5 -= ks[4] + ts[2]
	x6 -= ks[5] + ts[0]
	x7 -= ks[6] + 8

	u = x3 ^ x4
	x3 = u>>22 | u<<(64-22)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>56 | u<<(64-56)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>35 | u<<(64-35)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>8 | u<<(64-8)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>43 | u<<(64-43)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>39 | u<<(64-39)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>29 | u<<(64-29)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>25 | u<<(64-25)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>17 | u<<(64-17)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>10 | u<<(64-10)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>50 | u<<(64-50)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>13 | u<<(64-13)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>24 | u<<(64-24)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>34 | u<<(64-34)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>30 | u<<(64-30)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>39 | u<<(64-39)
	x0 -= x1

	x0 -= ks[7]
	x1 -= ks[8]
	x2 -= ks[0]
	x3 -= ks[1]
	x4 -= ks[2]
	x5 -= ks[3] + ts[1]
	x6 -= ks[4] + ts[2]
	x7 -= ks[5] + 7

	u = x3 ^ x4
	x3 = u>>56 | u<<(64-56)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>54 | u<<(64-54)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>9 | u<<(64-9)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>44 | u<<(64-44)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>39 | u<<(64-39)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>36 | u<<(64-36)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>49 | u<<(64-49)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>17 | u<<(64-17)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>42 | u<<(64-42)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>14 | u<<(64-14)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>27 | u<<(64-27)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>33 | u<<(64-33)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>37 | u<<(64-37)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>19 | u<<(64-19)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>36 | u<<(64-36)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>46 | u<<(64-46)
	x0 -= x1

	x0 -= ks[6]
	x1 -= ks[7]
	x2 -= ks[8]
	x3 -= ks[0]
	x4 -= ks[1]
	x5 -= ks[2] + ts[0]
	x6 -= ks[3] + ts[1]
	x7 -= ks[4] + 6

	u = x3 ^ x4
	x3 = u>>22 | u<<(64-22)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>56 | u<<(64-56)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>35 | u<<(64-35)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>8 | u<<(64-8)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>43 | u<<(64-43)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>39 | u<<(64-39)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>29 | u<<(64-29)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>25 | u<<(64-25)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>17 | u<<(64-17)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>10 | u<<(64-10)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>50 | u<<(64-50)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>13 | u<<(64-13)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>24 | u<<(64-24)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>34 | u<<(64-34)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>30 | u<<(64-30)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>39 | u<<(64-39)
	x0 -= x1

	x0 -= ks[5]
	x1 -= ks[6]
	x2 -= ks[7]
	x3 -= ks[8]
	x4 -= ks[0]
	x5 -= ks[1] + ts[2]
	x6 -= ks[2] + ts[0]
	x7 -= ks[3] + 5

	u = x3 ^ x4
	x3 = u>>56 | u<<(64-56)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>54 | u<<(64-54)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>9 | u<<(64-9)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>44 | u<<(64-44)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>39 | u<<(64-39)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>36 | u<<(64-36)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>49 | u<<(64-49)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>17 | u<<(64-17)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>42 | u<<(64-42)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>14 | u<<(64-14)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>27 | u<<(64-27)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>33 | u<<(64-33)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>37 | u<<(64-37)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>19 | u<<(64-19)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>36 | u<<(64-36)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>46 | u<<(64-46)
	x0 -= x1

	x0 -= ks[4]
	x1 -= ks[5]
	x2 -= ks[6]
	x3 -= ks[7]
	x4 -= ks[8]
	x5 -= ks[0] + ts[1]
	x6 -= ks[1] + ts[2]
	x7 -= ks[2] + 4

	u = x3 ^ x4
	x3 = u>>22 | u<<(64-22)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>56 | u<<(64-56)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>35 | u<<(64-35)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>8 | u<<(64-8)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>43 | u<<(64-43)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>39 | u<<(64-39)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>29 | u<<(64-29)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>25 | u<<(64-25)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>17 | u<<(64-17)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>10 | u<<(64-10)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>50 | u<<(64-50)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>13 | u<<(64-13)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>24 | u<<(64-24)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>34 | u<<(64-34)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>30 | u<<(64-30)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>39 | u<<(64-39)
	x0 -= x1

	x0 -= ks[3]
	x1 -= ks[4]
	x2 -= ks[5]
	x3 -= ks[6]
	x4 -= ks[7]
	x5 -= ks[8] + ts[0]
	x6 -= ks[0] + ts[1]
	x7 -= ks[1] + 3

	u = x3 ^ x4
	x3 = u>>56 | u<<(64-56)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>54 | u<<(64-54)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>9 | u<<(64-9)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>44 | u<<(64-44)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>39 | u<<(64-39)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>36 | u<<(64-36)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>49 | u<<(64-49)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>17 | u<<(64-17)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>42 | u<<(64-42)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>14 | u<<(64-14)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>27 | u<<(64-27)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>33 | u<<(64-33)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>37 | u<<(64-37)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>19 | u<<(64-19)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>36 | u<<(64-36)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>46 | u<<(64-46)
	x0 -= x1

	x0 -= ks[2]
	x1 -= ks[3]
	x2 -= ks[4]
	x3 -= ks[5]
	x4 -= ks[6]
	x5 -= ks[7] + ts[2]
	x6 -= ks[8] + ts[0]
	x7 -= ks[0] + 2

	u = x3 ^ x4
	x3 = u>>22 | u<<(64-22)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>56 | u<<(64-56)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>35 | u<<(64-35)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>8 | u<<(64-8)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>43 | u<<(64-43)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>39 | u<<(64-39)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>29 | u<<(64-29)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>25 | u<<(64-25)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>17 | u<<(64-17)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>10 | u<<(64-10)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>50 | u<<(64-50)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>13 | u<<(64-13)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>24 | u<<(64-24)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>34 | u<<(64-34)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>30 | u<<(64-30)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>39 | u<<(64-39)
	x0 -= x1

	x0 -= ks[1]
	x1 -= ks[2]
	x2 -= ks[3]
	x3 -= ks[4]
	x4 -= ks[5]
	x5 -= ks[6] + ts[1]
	x6 -= ks[7] + ts[2]
	x7 -= ks[8] + 1

	u = x3 ^ x4
	x3 = u>>56 | u<<(64-56)
	x4 -= x3
	u = x5 ^ x2
	x5 = u>>54 | u<<(64-54)
	x2 -= x5
	u = x7 ^ x0
	x7 = u>>9 | u<<(64-9)
	x0 -= x7
	u = x1 ^ x6
	x1 = u>>44 | u<<(64-44)
	x6 -= x1

	u = x7 ^ x2
	x7 = u>>39 | u<<(64-39)
	x2 -= x7
	u = x5 ^ x0
	x5 = u>>36 | u<<(64-36)
	x0 -= x5
	u = x3 ^ x6
	x3 = u>>49 | u<<(64-49)
	x6 -= x3
	u = x1 ^ x4
	x1 = u>>17 | u<<(64-17)
	x4 -= x1

	u = x3 ^ x0
	x3 = u>>42 | u<<(64-42)
	x0 -= x3
	u = x5 ^ x6
	x5 = u>>14 | u<<(64-14)
	x6 -= x5
	u = x7 ^ x4
	x7 = u>>27 | u<<(64-27)
	x4 -= x7
	u = x1 ^ x2
	x1 = u>>33 | u<<(64-33)
	x2 -= x1

	u = x7 ^ x6
	x7 = u>>37 | u<<(64-37)
	x6 -= x7
	u = x5 ^ x4
	x5 = u>>19 | u<<(64-19)
	x4 -= x5
	u = x3 ^ x2
	x3 = u>>36 | u<<(64-36)
	x2 -= x3
	u = x1 ^ x0
	x1 = u>>46 | u<<(64-46)
	x0 -= x1

	x0 -= ks[0]
	x1 -= ks[1]
	x2 -= ks[2]
	x3 -= ks[3]
	x4 -= ks[4]
	x5 -= ks[5] + ts[0]
	x6 -= ks[6] + ts[1]
	x7 -= ks[7]

	dst[0] = byte(x0)
	dst[1] = byte(x0 >> 8)
	dst[2] = byte(x0 >> 16)
	dst[3] = byte(x0 >> 24)
	dst[4] = byte(x0 >> 32)
	dst[5] = byte(x0 >> 40)
	dst[6] = byte(x0 >> 48)
	dst[7] = byte(x0 >> 56)

	dst[8] = byte(x1)
	dst[9] = byte(x1 >> 8)
	dst[10] = byte(x1 >> 16)
	dst[11] = byte(x1 >> 24)
	dst[12] = byte(x1 >> 32)
	dst[13] = byte(x1 >> 40)
	dst[14] = byte(x1 >> 48)
	dst[15] = byte(x1 >> 56)

	dst[16] = byte(x2)
	dst[17] = byte(x2 >> 8)
	dst[18] = byte(x2 >> 16)
	dst[19] = byte(x2 >> 24)
	dst[20] = byte(x2 >> 32)
	dst[21] = byte(x2 >> 40)
	dst[22] = byte(x2 >> 48)
	dst[23] = byte(x2 >> 56)

	dst[24] = byte(x3)
	dst[25] = byte(x3 >> 8)
	dst[26] = byte(x3 >> 16)
	dst[27] = byte(x3 >> 24)
	dst[28] = byte(x3 >> 32)
	dst[29] = byte(x3 >> 40)
	dst[30] = byte(x3 >> 48)
	dst[31] = byte(x3 >> 56)

	dst[32] = byte(x4)
	dst[33] = byte(x4 >> 8)
	dst[34] = byte(x4 >> 16)
	dst[35] = byte(x4 >> 24)
	dst[36] = byte(x4 >> 32)
	dst[37] = byte(x4 >> 40)
	dst[38] = byte(x4 >> 48)
	dst[39] = byte(x4 >> 56)

	dst[40] = byte(x5)
	dst[41] = byte(x5 >> 8)
	dst[42] = byte(x5 >> 16)
	dst[43] = byte(x5 >> 24)
	dst[44] = byte(x5 >> 32)
	dst[45] = byte(x5 >> 40)
	dst[46] = byte(x5 >> 48)
	dst[47] = byte(x5 >> 56)

	dst[48] = byte(x6)
	dst[49] = byte(x6 >> 8)
	dst[50] = byte(x6 >> 16)
	dst[51] = byte(x6 >> 24)
	dst[52] = byte(x6 >> 32)
	dst[53] = byte(x6 >> 40)
	dst[54] = byte(x6 >> 48)
	dst[55] = byte(x6 >> 56)

	dst[56] = byte(x7)
	dst[57] = byte(x7 >> 8)
	dst[58] = byte(x7 >> 16)
	dst[59] = byte(x7 >> 24)
	dst[60] = byte(x7 >> 32)
	dst[61] = byte(x7 >> 40)
	dst[62] = byte(x7 >> 48)
	dst[63] = byte(x7 >> 56)

}
